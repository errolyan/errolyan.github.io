# 第148期 帮你打造这个系统——智能SCADA安全系统（我的经验能帮到你）


基于人工智能的SCADA入侵检测系统架构（使用ChatGPT制作）

我正在研发一项让我兴奋得夜不能寐的技术——为工业网络打造一套入侵检测系统。该系统能够检测出试图入侵电网、供水系统以及制造工厂的黑客。

以下是我目前的工作进展：
![HhX7Tn](https://raw.githubusercontent.com/errolyan/tuchuang/master/uPic/HhX7Tn.png)

### 核心问题
试想一下，若有人入侵水处理厂，或是让整个电网陷入瘫痪，后果将不堪设想。SCADA系统（监控和数据采集系统）掌控着我们的关键基础设施，而其中许多系统都存在安全漏洞。

更可怕的是，传统安全工具在这类场景下难以有效发挥作用。工业网络采用Modbus和DNP3等特殊协议，常规入侵检测系统会被这些协议干扰，无法正常工作。

### 我的项目：工业网络人工智能安全系统
我正致力于构建一套具备以下功能的系统：
- 监听SCADA设备之间的网络流量
- 通过机器学习，结合反馈数据来学习设备的正常运行行为
- 实时识别异常情况
- 在造成损失前向操作人员发出警报

可以把这套系统比作一位熟悉每位员工日常工作流程的保安。一旦有人行为异常，这位保安能立刻察觉。

### 系统工作原理
#### 第一步：监控“对话”
我会捕获可编程逻辑控制器（PLC）、人机界面（HMI）以及现场设备之间的网络流量。这些设备通过Modbus和DNP3协议进行数据交互。

#### 第二步：学习“正常”模式
系统会学习以下各类正常运行模式：
- 哪些设备之间应当存在数据交互
- 正常的指令序列
- 消息发送之间的典型时间间隔
- 预期的数据值范围

#### 第三步：识别“异常”情况
当出现以下异常情况时，系统会及时发现：
- 某一设备与本不应交互的设备进行数据传输
- 指令在异常时间点发送
- 数据值超出正常范围
- 出现异常的指令序列

#### 第四步：精准告警
系统会直接在操作人员日常使用的SCADA仪表盘上显示告警信息。

### 机器学习相关工作
目前我正在测试三种机器学习方案：
1. **自编码器（Autoencoders）**：这类模型会学习如何重构正常的网络流量。当遇到异常流量时，它们难以准确重构，从而识别出异常。
2. **长短期记忆网络（LSTM Networks）**：该模型擅长识别一段时间内出现的异常指令序列。
3. **图神经网络（Graph Neural Networks）**：能够学习设备之间正常的关联关系。

目前来看，自编码器方案展现出了最大的潜力。这种方式就如同教系统学会“读懂”工业设备之间“正常对话”的样子。

### 目前已完成的工作
（暂无具体已完成工作的详细描述）

### 亟需你的宝贵建议
#### 1. 特征工程
在网络特征提取方面，我应重点关注哪些内容？目前我正在追踪以下特征：
- 数据发送端/接收端设备信息
- 指令类型及出现频率
- 数据包的时间戳和大小
- 数据值范围

除此之外，我还遗漏了哪些特征？工业场景中还有哪些特定模式值得关注？

#### 2. 模型选择
自编码器的效果尚可，但我认为或许存在更优的方案。你是否有处理工业数据的经验？哪些模型在你过往的实践中效果较好？

#### 3. 真实场景测试
目前我使用CICIDS2017和SWaT数据集进行模型训练，但如何确保这套系统在真实工厂环境中也能正常工作？关于开展贴近实际场景的测试，你有什么建议吗？

#### 4. 告警管理
如何避免操作人员出现“告警疲劳”？操作人员对误报深恶痛绝，怎样才能让告警信息真正发挥作用，而不是成为一种困扰？

### 我使用的数据集
- **CICIDS2017数据集**：包含带有攻击行为的通用网络流量数据
- **SWaT数据集**：包含真实水处理厂场景下的数据集，其中涵盖攻击场景数据

但我担心这两个数据集无法覆盖所有工业场景。

### 我面临的主要挑战
#### 1. “正常即平淡”问题
工业网络的运行本应具有可预测性，这就导致异常情况极为罕见。如何基于大量正常数据开展模型训练，是我面临的一大难题。

#### 2. 安全关键平衡问题
误报会让操作人员厌烦，而漏报则可能引发灾难性后果。如何在两者之间找到恰当的平衡点，是亟待解决的问题。

#### 3. 实时性能问题
SCADA系统无法容忍分析过程耗时数分钟，所有数据分析必须在数秒内完成。

### 期待你的参与
你是否有工业安全、异常检测或SCADA系统相关的工作经验？

我非常希望能听到你的看法：
- 从Modbus/DNP3协议流量中，你会提取哪些特征？
- 你会优先尝试哪种机器学习方案？
- 在不影响真实系统正常运行的前提下，该如何开展测试？
- 我可能忽略了哪些工业场景，需要纳入考虑范围？